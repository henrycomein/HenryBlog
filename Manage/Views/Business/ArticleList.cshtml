@{
    ViewBag.Title = "Article";
}

@section scripts{
    <script src="~/Scripts/jquery.blockUI.js"></script>
    <script src="~/Scripts/jquery.pagination.js"></script>
    <script src="~/Scripts/lhgdialog/lhgdialog.min.js?skin=jtop"></script>
    <script src="~/Scripts/lhgdialog/lhgdialogPlus.js"></script>
    <script type="text/javascript">
        $(function () {
            var condition = { content: '', category: 0, pageindex: 1, pagesize: 10 };
            var opt = tools.pagedefaultops;
            var firstRequest = true;
            opt.callback = function (pageindex) {
                condition.pageindex = pageindex + 1;
                search();
            }

            function search() {
                var callback = function (data) {
                    $("#article-table tbody").empty();
                    var htmlArray = [];
                    if (data.total > 0) {
                        $.each(data.items, function (i, item) {
                            if (i % 2 == 0)
                                htmlArray.push('<tr class="odd">');
                            else
                                htmlArray.push('<tr class="even">');
                            htmlArray.push('<td >' + item.category.replace(/,/g, ' <i class="fa fa-caret-right"></i> ') + '</td>');
                            htmlArray.push('<td><a href="javascript:;" >' + item.title + '</a></td>');
                            htmlArray.push('<td class="center">' + item.sort + '</td>');
                            htmlArray.push('<td class="center">' + (item.istop ? ' <i class="green fa fa-check-circle bigger-130" title="是"></i>' : '<i class="orange fa fa-minus-circle bigger-130" title="否"></i>') + '</td>');
                            htmlArray.push('<td class="center">' + (item.status ? ' <i class="green fa fa-check-circle bigger-130" title="是"></i>' : '<i class="red fa fa-minus-circle bigger-130" title="否"></i>') + '</td>');
                            htmlArray.push('<td class="center"><div class=" action-buttons">');
                            htmlArray.push('<a class="green" data-title="编辑" data-rel="popup" data-width="800px" data-height="560px" data-content="url:{dns}Business/Article/' + item.id + '" href="javascript:;" title="编辑"  ><i class="ace-icon fa fa-pencil bigger-130"></i></a>');
                            htmlArray.push('&nbsp;<a class="red" data-rel="delete" href="javascript:;" title="删除" data-category="article" data-id="' + item.id + '"  data-content="确定删除吗？"><i class="ace-icon fa fa-trash-o bigger-130"></i></a>');
                            htmlArray.push('</div></td></tr>');

                        });
                    }
                    else {
                        htmlArray.push('<tr><td colspan="6" class="center">No Data Found!</td></tr>');
                    }
                    $("#article-table tbody").append(htmlArray.join(''));
                    $("#article-table-info").html('总共 ' + data.total + ' ');
                    if (firstRequest) {
                        firstRequest = false;
                        $("#pagination").pagination(data.total, opt);
                    }
                };
                tools.postData('{dns}api/article/list', condition, callback, '#article-table');

            }

            $("#btn-search").click(function () {
                condition.content = '';
                condition.category = 0;
                condition.pageindex = 1;
                firstRequest = true;
                search();
            });
            search();
        });
    </script>
}
<div class="page-header">
    <h1>文章列表
		<small>
            <i class="ace-icon fa fa-angle-double-right"></i>
        </small>
        <button class="btn btn-info" type="button" title="新增" data-rel="popup" data-content="url:{dns}business/article" data-width="800px" data-height="560px" data-title="新增">
            <i class="ace-icon fa fa-plus bigger150"></i>新增
        </button>
    </h1>
</div>
<div class="col-xs-12">
    <div>
        <div class="dataTables_wrapper form-inline no-footer">
            <table id="article-table" class="table table-striped table-bordered table-hover dataTable no-footer DTTT_selectable" role="grid" aria-describedby="dynamic-table_info">
                <thead>
                    <tr>
                        <th class="center col-xs-4">类别</th>
                        <th class="center col-xs-4">标题</th>
                        <th class="center col-xs-1">排序</th>
                        <th class="center col-xs-1">置顶</th>
                        <th class="center col-xs-1">状态</th>
                        <th class="center col-xs-1">操作</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <div class="row">
                <div class="col-xs-6">
                    <div class="dataTables_info" id="article-table-info"></div>
                </div>
                <div class="col-xs-6">
                    <div class="dataTables_paginate paging_simple_numbers">
                        <ul class="pagination" id="pagination"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

